{"remainingRequest":"D:\\项目\\vue\\travel\\travel\\node_modules\\babel-loader\\lib\\index.js!D:\\项目\\vue\\travel\\travel\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\项目\\vue\\travel\\travel\\node_modules\\vue-cli-plugin-vue-next\\node_modules\\vue-loader\\dist\\index.js??ref--0-1!D:\\项目\\vue\\travel\\travel\\src\\pages\\city\\components\\Search.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\项目\\vue\\travel\\travel\\src\\pages\\city\\components\\Search.vue","mtime":1594463195866},{"path":"D:\\项目\\vue\\travel\\travel\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\项目\\vue\\travel\\travel\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\项目\\vue\\travel\\travel\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\项目\\vue\\travel\\travel\\node_modules\\vue-cli-plugin-vue-next\\node_modules\\vue-loader\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zZWFyY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKaW1wb3J0IHsgcmVmLCBjb21wdXRlZCwgd2F0Y2gsIG9uTW91bnRlZCB9IGZyb20gJ3Z1ZSc7CmltcG9ydCBCc2Nyb2xsIGZyb20gJ2JldHRlci1zY3JvbGwnOwppbXBvcnQgeyB1c2VTdG9yZSB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICd2dWUtcm91dGVyJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdDaXR5U2VhcmNoJywKICBwcm9wczogWydjaXRpZXMnXSwKICBzZXR1cDogZnVuY3Rpb24gc2V0dXAocHJvcHMpIHsKICAgIHZhciBrZXl3b3JkID0gcmVmKCcnKTsKICAgIHZhciBsaXN0ID0gcmVmKFtdKTsKICAgIHZhciB0aW1lciA9IG51bGw7CiAgICB2YXIgc3RvcmUgPSB1c2VTdG9yZSgpOwogICAgdmFyIHJvdXRlciA9IHVzZVJvdXRlcigpOwogICAgdmFyIHNlYXJjaCA9IHJlZihudWxsKTsKICAgIHZhciBoYXNOb0RhdGEgPSBjb21wdXRlZChmdW5jdGlvbiAoKSB7CiAgICAgICFsaXN0Lmxlbmd0aDsKICAgIH0pOwogICAgd2F0Y2goa2V5d29yZCwgZnVuY3Rpb24gKGtleXdvcmQsIHByZXZLZXl3b3JkKSB7CiAgICAgIGlmICh0aW1lcikgewogICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7CiAgICAgICAgdGltZXIgPSBudWxsOwogICAgICB9CgogICAgICBpZiAoIWtleXdvcmQudmFsdWUpIHsKICAgICAgICBsaXN0LnZhbHVlID0gW107CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIHZhciByZXN1bHQgPSBbXTsKCiAgICAgICAgZm9yICh2YXIgaSBpbiBwcm9wcy5jaXRpZXMpIHsKICAgICAgICAgIHByb3BzLmNpdGllc1tpXS5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgICAgICBpZiAodmFsdWUuc3BlbGwuaW5kZXhPZihrZXl3b3JkKSA+IC0xIHx8IHZhbHVlLm5hbWUuaW5kZXhPZihrZXl3b3JkKSA+IC0xKSB7CiAgICAgICAgICAgICAgcmVzdWx0LnB1c2godmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGxpc3QudmFsdWUgPSByZXN1bHQ7CiAgICAgIH0sIDEwMCk7CiAgICB9KTsKCiAgICBmdW5jdGlvbiBoYW5kbGVDaXR5Q2xpY2soY2l0eSkgewogICAgICBzdG9yZS5jb21taXQoJ2NoYW5nZUNpdHknLCBjaXR5KTsKICAgICAgcm91dGVyLnB1c2goJy8nKTsKICAgIH0KCiAgICBvbk1vdW50ZWQoZnVuY3Rpb24gKCkgewogICAgICBuZXcgQnNjcm9sbChzZWFyY2gudmFsdWUsIHt9KTsKICAgIH0pOwogICAgcmV0dXJuIHsKICAgICAgc2VhcmNoOiBzZWFyY2gsCiAgICAgIGhhc05vRGF0YTogaGFzTm9EYXRhLAogICAgICBrZXl3b3JkOiBrZXl3b3JkLAogICAgICBsaXN0OiBsaXN0LAogICAgICBoYW5kbGVDaXR5Q2xpY2s6IGhhbmRsZUNpdHlDbGljawogICAgfTsKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBrZXl3b3JkOiAnJywKICAgICAgbGlzdDogW10sCiAgICAgIHRpbWVyOiBudWxsCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgaGFuZGxlQ2l0eUNsaWNrOiBmdW5jdGlvbiBoYW5kbGVDaXR5Q2xpY2soY2l0eSkgewogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2NoYW5nZUNpdHknLCBjaXR5KTsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy8nKTsKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBoYXNOb0RhdGE6IGZ1bmN0aW9uIGhhc05vRGF0YSgpIHsKICAgICAgcmV0dXJuICF0aGlzLmxpc3QubGVuZ3RoOwogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHRoaXMuc2Nyb2xsID0gbmV3IEJzY3JvbGwodGhpcy4kcmVmcy5zZWFyY2gsIHt9KTsKICB9LAogIHdhdGNoOiB7CiAgICBrZXl3b3JkOiBmdW5jdGlvbiBrZXl3b3JkKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMudGltZXIpIHsKICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcik7CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5rZXl3b3JkKSB7CiAgICAgICAgdGhpcy5saXN0ID0gW107CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLnRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHJlc3VsdCA9IFtdOwoKICAgICAgICBmb3IgKHZhciBpIGluIF90aGlzLmNpdGllcykgewogICAgICAgICAgX3RoaXMuY2l0aWVzW2ldLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICAgIGlmICh2YWx1ZS5zcGVsbC5pbmRleE9mKF90aGlzLmtleXdvcmQpID4gLTEgfHwgdmFsdWUubmFtZS5pbmRleE9mKF90aGlzLmtleXdvcmQpID4gLTEpIHsKICAgICAgICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMubGlzdCA9IHJlc3VsdDsKICAgICAgfSwgMTAwKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["D:\\项目\\vue\\travel\\travel\\src\\pages\\city\\components\\Search.vue"],"names":[],"mappings":";;;;;;AAyBA,SAAS,GAAT,EAAc,QAAd,EAAwB,KAAxB,EAA+B,SAA/B,QAAgD,KAAhD;AACA,OAAO,OAAP,MAAoB,eAApB;AACA,SAAS,QAAT,QAAyB,MAAzB;AACA,SAAS,SAAT,QAA0B,YAA1B;AACA,eAAe;AACb,EAAA,IAAI,EAAE,YADO;AAEb,EAAA,KAAK,EAAE,CAAC,QAAD,CAFM;AAGb,EAAA,KAHa,iBAGP,KAHO,EAGA;AACX,QAAM,OAAM,GAAI,GAAG,CAAC,EAAD,CAAnB;AACA,QAAM,IAAG,GAAI,GAAG,CAAC,EAAD,CAAhB;AACA,QAAI,KAAI,GAAI,IAAZ;AACA,QAAM,KAAI,GAAI,QAAQ,EAAtB;AACA,QAAM,MAAK,GAAI,SAAS,EAAxB;AACA,QAAM,MAAK,GAAI,GAAG,CAAC,IAAD,CAAlB;AACA,QAAM,SAAQ,GAAI,QAAQ,CAAC,YAAI;AAC7B,OAAC,IAAI,CAAC,MAAN;AACD,KAFyB,CAA1B;AAIA,IAAA,KAAK,CAAC,OAAD,EAAS,UAAC,OAAD,EAAS,WAAT,EAAuB;AACnC,UAAI,KAAJ,EAAW;AACT,QAAA,YAAY,CAAC,KAAD,CAAZ;AACA,QAAA,KAAI,GAAI,IAAR;AACF;;AACA,UAAI,CAAC,OAAO,CAAC,KAAb,EAAoB;AAClB,QAAA,IAAI,CAAC,KAAL,GAAa,EAAb;AACA;AACF;;AACA,MAAA,KAAI,GAAI,UAAU,CAAC,YAAM;AACvB,YAAM,MAAK,GAAI,EAAf;;AACA,aAAK,IAAI,CAAT,IAAc,KAAK,CAAC,MAApB,EAA4B;AAC1B,UAAA,KAAK,CAAC,MAAN,CAAa,CAAb,EAAgB,OAAhB,CAAwB,UAAC,KAAD,EAAW;AACjC,gBAAI,KAAK,CAAC,KAAN,CAAY,OAAZ,CAAoB,OAApB,IAA+B,CAAC,CAAhC,IACF,KAAK,CAAC,IAAN,CAAW,OAAX,CAAmB,OAAnB,IAA8B,CAAC,CADjC,EACoC;AAClC,cAAA,MAAM,CAAC,IAAP,CAAY,KAAZ;AACF;AACD,WALD;AAMF;;AACA,QAAA,IAAI,CAAC,KAAL,GAAa,MAAb;AACD,OAXiB,EAWf,GAXe,CAAlB;AAYD,KArBI,CAAL;;AAuBA,aAAS,eAAT,CAAyB,IAAzB,EAA8B;AAC5B,MAAA,KAAK,CAAC,MAAN,CAAa,YAAb,EAA0B,IAA1B;AACA,MAAA,MAAM,CAAC,IAAP,CAAY,GAAZ;AACF;;AAEA,IAAA,SAAS,CAAC,YAAI;AACZ,UAAI,OAAJ,CAAY,MAAM,CAAC,KAAnB,EAA0B,EAA1B;AACD,KAFQ,CAAT;AAGA,WAAO;AAAE,MAAA,MAAM,EAAN,MAAF;AAAU,MAAA,SAAS,EAAT,SAAV;AAAqB,MAAA,OAAO,EAAP,OAArB;AAA8B,MAAA,IAAI,EAAJ,IAA9B;AAAoC,MAAA,eAAe,EAAf;AAApC,KAAP;AACD,GA9CY;AA+Cb,EAAA,IA/Ca,kBA+CL;AACN,WAAO;AACL,MAAA,OAAO,EAAE,EADJ;AAEL,MAAA,IAAI,EAAE,EAFD;AAGL,MAAA,KAAK,EAAE;AAHF,KAAP;AAKD,GArDY;AAsDb,EAAA,OAAO,EAAE;AACP,IAAA,eADO,2BACU,IADV,EACgB;AACrB,WAAK,MAAL,CAAY,MAAZ,CAAmB,YAAnB,EAAiC,IAAjC;AACA,WAAK,OAAL,CAAa,IAAb,CAAkB,GAAlB;AACF;AAJO,GAtDI;AA4Db,EAAA,QAAQ,EAAE;AACR,IAAA,SADQ,uBACK;AACX,aAAO,CAAC,KAAK,IAAL,CAAU,MAAlB;AACF;AAHQ,GA5DG;AAiEb,EAAA,OAjEa,qBAiEF;AACT,SAAK,MAAL,GAAc,IAAI,OAAJ,CAAY,KAAK,KAAL,CAAW,MAAvB,EAA+B,EAA/B,CAAd;AACD,GAnEY;AAoEb,EAAA,KAAK,EAAE;AACL,IAAA,OADK,qBACM;AAAA;;AACT,UAAI,KAAK,KAAT,EAAgB;AACd,QAAA,YAAY,CAAC,KAAK,KAAN,CAAZ;AACF;;AACA,UAAI,CAAC,KAAK,OAAV,EAAmB;AACjB,aAAK,IAAL,GAAY,EAAZ;AACA;AACF;;AACA,WAAK,KAAL,GAAa,UAAU,CAAC,YAAM;AAC5B,YAAM,MAAK,GAAI,EAAf;;AACA,aAAK,IAAI,CAAT,IAAc,KAAI,CAAC,MAAnB,EAA2B;AACzB,UAAA,KAAI,CAAC,MAAL,CAAY,CAAZ,EAAe,OAAf,CAAuB,UAAC,KAAD,EAAW;AAChC,gBAAI,KAAK,CAAC,KAAN,CAAY,OAAZ,CAAoB,KAAI,CAAC,OAAzB,IAAoC,CAAC,CAArC,IACF,KAAK,CAAC,IAAN,CAAW,OAAX,CAAmB,KAAI,CAAC,OAAxB,IAAmC,CAAC,CADtC,EACyC;AACvC,cAAA,MAAM,CAAC,IAAP,CAAY,KAAZ;AACF;AACD,WALD;AAMF;;AACA,QAAA,KAAI,CAAC,IAAL,GAAY,MAAZ;AACD,OAXsB,EAWpB,GAXoB,CAAvB;AAYF;AArBK;AApEM,CAAf","sourcesContent":["<template>\n  <div>\n    <div class=\"search\">\n      <input class=\"search-input\" type=\"text\" placeholder=\"输入城市名或拼音\" v-model=\"keyword\">\n    </div>\n    <div\n      class=\"search-content\"\n      ref=\"search\"\n      v-show=\"keyword\"\n    >\n      <ul>\n        <li\n          class=\"search-item border-bottom\"\n          v-for=\"item of list\"\n          :key=\"item.id\"\n          @click=\"handleCityClick(item.name)\"\n        >\n          {{item.name}}\n        </li>\n        <li class=\"search-item border-bottom\" v-show=\"hasNoData\">没有找到匹配数据</li>\n      </ul>\n    </div>\n  </div>\n</template>\n<script>\nimport { ref, computed, watch, onMounted } from 'vue'\nimport Bscroll from 'better-scroll'\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\nexport default {\n  name: 'CitySearch',\n  props: ['cities'],\n  setup(props) {\n    const keyword = ref('')\n    const list = ref([])\n    let timer = null\n    const store = useStore()\n    const router = useRouter()\n    const search = ref(null)\n    const hasNoData = computed(()=>{\n      !list.length\n    })\n\n    watch(keyword,(keyword,prevKeyword)=>{\n      if (timer) {\n        clearTimeout(timer)\n        timer = null\n      }\n      if (!keyword.value) {\n        list.value = []\n        return\n      }\n      timer = setTimeout(() => {\n        const result = []\n        for (let i in props.cities) {\n          props.cities[i].forEach((value) => {\n            if (value.spell.indexOf(keyword) > -1 ||\n              value.name.indexOf(keyword) > -1) {\n              result.push(value)\n            }\n          })\n        }\n        list.value = result\n      }, 100)\n    })\n\n    function handleCityClick(city){\n      store.commit('changeCity',city)\n      router.push('/')\n    }\n\n    onMounted(()=>{\n      new Bscroll(search.value, {})\n    })\n    return { search, hasNoData, keyword, list, handleCityClick}\n  },\n  data () {\n    return {\n      keyword: '',\n      list: [],\n      timer: null\n    }\n  },\n  methods: {\n    handleCityClick (city) {\n      this.$store.commit('changeCity', city)\n      this.$router.push('/')\n    }\n  },\n  computed: {\n    hasNoData () {\n      return !this.list.length\n    }\n  },\n  mounted () {\n    this.scroll = new Bscroll(this.$refs.search, {})\n  },\n  watch: {\n    keyword () {\n      if (this.timer) {\n        clearTimeout(this.timer)\n      }\n      if (!this.keyword) {\n        this.list = []\n        return\n      }\n      this.timer = setTimeout(() => {\n        const result = []\n        for (let i in this.cities) {\n          this.cities[i].forEach((value) => {\n            if (value.spell.indexOf(this.keyword) > -1 ||\n              value.name.indexOf(this.keyword) > -1) {\n              result.push(value)\n            }\n          })\n        }\n        this.list = result\n      }, 100)\n    }\n  }\n}\n</script>\n<style lang=\"stylus\" scoped>\n  @import \"~styles/varibles.styl\"\n  .search\n    height .72rem\n    padding 0 .1rem\n    background $bgColor\n    .search-input\n      box-sizing border-box\n      height .62rem\n      line-height .62rem\n      width 100%\n      padding 0 .1rem\n      line-height .62rem\n      text-align center\n      border-radius .06rem\n      color #666\n  .search-content\n    z-index 1\n    position absolute\n    overflow hidden\n    top 1.58rem\n    left 0\n    right 0\n    bottom 0\n    background #eee\n    .search-item\n      line-height .62rem\n      padding-left .2rem\n      background #fff\n      color #666\n</style>\n"],"sourceRoot":""}]}